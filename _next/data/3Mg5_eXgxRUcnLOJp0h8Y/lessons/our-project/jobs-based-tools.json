{"pageProps":{"post":{"attributes":{"description":"Brian Holt presents a practical, jobs-oriented MCP server from the Complete Intro to MCP course, illustrating how to implement three focused actions with the Model Context Protocol: create high-priority bugs, create low-priority feature requests, and update ticket status. The piece includes JavaScript code for a minimal MCP server and discusses reliability over flexibility using real-world tool selection inspired by Qwen3.6B experiments.","keywords":["mcp","model context protocol","ai agents","bug tracking","ticket status update","Brian Holt","Complete Intro to MCP"]},"html":"<p>Here&#39;s a real interaction using the complete MCP server I just had with Qwen3:0.6B.</p>\n<pre><code><button class=\"copy-btn\">Copy</button>&gt; ðŸ‘¤ using the issues-tracker-server mcp server, create a new issue in my issue tracker that tracks that I need to fix the login bug and mark it urgent and assign it to me. use the api key &lt;API_KEY&gt;\n\n&gt; ðŸ¤– The tool call was made with the assigned_user_id set to &quot;me&quot;, but the system is rejecting this, indicating a mismatch. The error suggests that the assigned user ID &quot;me&quot; does not exist in the system. Could you confirm that your assigned user ID is correctly set to &quot;your-own-id&quot; instead? Let me know, and I&#x27;ll assist accordingly\n</code></pre><p>This is where just mapping your API server to an MCP server runs into trouble.</p>\n<ul>\n<li>Sequential calls are hard to get right. In this case it&#39;d need to use the API key to try to figure out who you are, then call create issue with that ID.</li>\n<li>Giving a agent lots of tools may mean that it can be more flexible but it also leads to confusion. Just by including the health check, it will call it at unexpected times! Agents will make weird, questionable, or even downright-wrong decisions with which tool to use. A smaller set of focused tools is much more likely to succeed.</li>\n<li>Generally speaking, you know the few actions you want your model to take. It&#39;s better to just codify these and slowly add more actions later.</li>\n</ul>\n<p>I&#39;m going to call this &quot;jobs oriented&quot; MCP server as opposed to &quot;API oriented&quot;. I made up these terms. But it suits what we&#39;re trying to get done today.</p>\n<p>Instead of having our infinitely flexible API server and hoping the LLM chooses right, let&#39;s say we know we really only want our MCP server to do three thinks</p>\n<ul>\n<li>Create new bugs and mark them as high priority</li>\n<li>Create new feature request and mark them as low priority</li>\n<li>Update the status of a ticket</li>\n</ul>\n<p>Frankly, after writing these, they aren&#39;t that different. But man, the difference in success particularly with Qwen3:.6 is <strong>night</strong> and <strong>day</strong>.</p>\n<pre><code class=\"hljs language-javascript\"><button class=\"copy-btn\">Copy</button><span class=\"hljs-keyword\">import</span> { z } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&quot;zod&quot;</span>;\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">jobsBasedTools</span>(<span class=\"hljs-params\">server</span>) {\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">API_BASE_URL</span> = process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">API_BASE_URL</span> || <span class=\"hljs-string\">&quot;http://localhost:3000/api&quot;</span>;\n\n  <span class=\"hljs-comment\">// Hardcoded tag IDs from database</span>\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">BUG_TAG_ID</span> = <span class=\"hljs-number\">3</span>;\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">FEATURE_TAG_ID</span> = <span class=\"hljs-number\">4</span>; <span class=\"hljs-comment\">// Helper function to make HTTP requests</span>\n  <span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">makeRequest</span>(<span class=\"hljs-params\">method, url, data = <span class=\"hljs-literal\">null</span>, options = {}</span>) {\n    <span class=\"hljs-keyword\">const</span> config = {\n      method,\n      <span class=\"hljs-attr\">headers</span>: {\n        <span class=\"hljs-string\">&quot;Content-Type&quot;</span>: <span class=\"hljs-string\">&quot;application/json&quot;</span>,\n        ...options.<span class=\"hljs-property\">headers</span>,\n      },\n    };\n\n    <span class=\"hljs-comment\">// Merge other options except headers (which we already handled)</span>\n    <span class=\"hljs-keyword\">const</span> { <span class=\"hljs-attr\">headers</span>: _, ...otherOptions } = options;\n    <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">assign</span>(config, otherOptions);\n\n    <span class=\"hljs-keyword\">if</span> (data) {\n      config.<span class=\"hljs-property\">body</span> = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(data);\n    }\n\n    <span class=\"hljs-keyword\">try</span> {\n      <span class=\"hljs-keyword\">const</span> response = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">fetch</span>(url, config);\n      <span class=\"hljs-keyword\">const</span> result = <span class=\"hljs-keyword\">await</span> response.<span class=\"hljs-title function_\">text</span>();\n\n      <span class=\"hljs-keyword\">let</span> jsonResult;\n      <span class=\"hljs-keyword\">try</span> {\n        jsonResult = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(result);\n      } <span class=\"hljs-keyword\">catch</span> {\n        jsonResult = result;\n      }\n\n      <span class=\"hljs-keyword\">return</span> {\n        <span class=\"hljs-attr\">status</span>: response.<span class=\"hljs-property\">status</span>,\n        <span class=\"hljs-attr\">data</span>: jsonResult,\n        <span class=\"hljs-attr\">headers</span>: <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">fromEntries</span>(response.<span class=\"hljs-property\">headers</span>.<span class=\"hljs-title function_\">entries</span>()),\n      };\n    } <span class=\"hljs-keyword\">catch</span> (error) {\n      <span class=\"hljs-keyword\">return</span> {\n        <span class=\"hljs-attr\">status</span>: <span class=\"hljs-number\">0</span>,\n        <span class=\"hljs-attr\">error</span>: error.<span class=\"hljs-property\">message</span>,\n      };\n    }\n  }\n\n  <span class=\"hljs-comment\">// Tool 1: Create new bug with high priority</span>\n  server.<span class=\"hljs-title function_\">registerTool</span>(\n    <span class=\"hljs-string\">&quot;create-bug&quot;</span>,\n    {\n      <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">&quot;Create High Priority Bug&quot;</span>,\n      <span class=\"hljs-attr\">description</span>: <span class=\"hljs-string\">&quot;Create a new bug issue with high priority and bug tag&quot;</span>,\n      <span class=\"hljs-attr\">inputSchema</span>: {\n        <span class=\"hljs-attr\">title</span>: z.<span class=\"hljs-title function_\">string</span>().<span class=\"hljs-title function_\">describe</span>(<span class=\"hljs-string\">&quot;Bug title&quot;</span>),\n        <span class=\"hljs-attr\">description</span>: z.<span class=\"hljs-title function_\">string</span>().<span class=\"hljs-title function_\">describe</span>(<span class=\"hljs-string\">&quot;Bug description&quot;</span>),\n        <span class=\"hljs-attr\">apiKey</span>: z.<span class=\"hljs-title function_\">string</span>().<span class=\"hljs-title function_\">describe</span>(<span class=\"hljs-string\">&quot;API key for authentication&quot;</span>),\n      },\n    },\n    <span class=\"hljs-title function_\">async</span> (params) =&gt; {\n      <span class=\"hljs-keyword\">const</span> { apiKey, ...bugData } = params;\n\n      <span class=\"hljs-comment\">// Create bug with high priority and bug tag</span>\n      <span class=\"hljs-keyword\">const</span> issueData = {\n        ...bugData,\n        <span class=\"hljs-attr\">priority</span>: <span class=\"hljs-string\">&quot;high&quot;</span>,\n        <span class=\"hljs-attr\">status</span>: <span class=\"hljs-string\">&quot;not_started&quot;</span>,\n        <span class=\"hljs-attr\">tag_ids</span>: [<span class=\"hljs-variable constant_\">BUG_TAG_ID</span>], <span class=\"hljs-comment\">// Hardcoded bug tag ID</span>\n      };\n\n      <span class=\"hljs-keyword\">const</span> result = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">makeRequest</span>(\n        <span class=\"hljs-string\">&quot;POST&quot;</span>,\n        <span class=\"hljs-string\">`<span class=\"hljs-subst\">${API_BASE_URL}</span>/issues`</span>,\n        issueData,\n        { <span class=\"hljs-attr\">headers</span>: { <span class=\"hljs-string\">&quot;x-api-key&quot;</span>: apiKey } }\n      );\n\n      <span class=\"hljs-keyword\">return</span> {\n        <span class=\"hljs-attr\">content</span>: [\n          {\n            <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&quot;text&quot;</span>,\n            <span class=\"hljs-attr\">text</span>: <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(result, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-number\">2</span>),\n          },\n        ],\n      };\n    }\n  );\n\n  <span class=\"hljs-comment\">// Tool 2: Create new feature request with low priority</span>\n  server.<span class=\"hljs-title function_\">registerTool</span>(\n    <span class=\"hljs-string\">&quot;create-feature-request&quot;</span>,\n    {\n      <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">&quot;Create Low Priority Feature Request&quot;</span>,\n      <span class=\"hljs-attr\">description</span>:\n        <span class=\"hljs-string\">&quot;Create a new feature request issue with low priority and feature tag&quot;</span>,\n      <span class=\"hljs-attr\">inputSchema</span>: {\n        <span class=\"hljs-attr\">title</span>: z.<span class=\"hljs-title function_\">string</span>().<span class=\"hljs-title function_\">describe</span>(<span class=\"hljs-string\">&quot;Feature request title&quot;</span>),\n        <span class=\"hljs-attr\">description</span>: z.<span class=\"hljs-title function_\">string</span>().<span class=\"hljs-title function_\">describe</span>(<span class=\"hljs-string\">&quot;Feature request description&quot;</span>),\n        <span class=\"hljs-attr\">apiKey</span>: z.<span class=\"hljs-title function_\">string</span>().<span class=\"hljs-title function_\">describe</span>(<span class=\"hljs-string\">&quot;API key for authentication&quot;</span>),\n      },\n    },\n    <span class=\"hljs-title function_\">async</span> (params) =&gt; {\n      <span class=\"hljs-keyword\">const</span> { apiKey, ...featureData } = params;\n\n      <span class=\"hljs-comment\">// Create feature request with low priority and feature tag</span>\n      <span class=\"hljs-keyword\">const</span> issueData = {\n        ...featureData,\n        <span class=\"hljs-attr\">priority</span>: <span class=\"hljs-string\">&quot;low&quot;</span>,\n        <span class=\"hljs-attr\">status</span>: <span class=\"hljs-string\">&quot;not_started&quot;</span>,\n        <span class=\"hljs-attr\">tag_ids</span>: [<span class=\"hljs-variable constant_\">FEATURE_TAG_ID</span>], <span class=\"hljs-comment\">// Hardcoded feature tag ID</span>\n      };\n\n      <span class=\"hljs-keyword\">const</span> result = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">makeRequest</span>(\n        <span class=\"hljs-string\">&quot;POST&quot;</span>,\n        <span class=\"hljs-string\">`<span class=\"hljs-subst\">${API_BASE_URL}</span>/issues`</span>,\n        issueData,\n        { <span class=\"hljs-attr\">headers</span>: { <span class=\"hljs-string\">&quot;x-api-key&quot;</span>: apiKey } }\n      );\n\n      <span class=\"hljs-keyword\">return</span> {\n        <span class=\"hljs-attr\">content</span>: [\n          {\n            <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&quot;text&quot;</span>,\n            <span class=\"hljs-attr\">text</span>: <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(result, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-number\">2</span>),\n          },\n        ],\n      };\n    }\n  );\n\n  <span class=\"hljs-comment\">// Tool 3: Update ticket status</span>\n  server.<span class=\"hljs-title function_\">registerTool</span>(\n    <span class=\"hljs-string\">&quot;update-ticket-status&quot;</span>,\n    {\n      <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">&quot;Update Ticket Status&quot;</span>,\n      <span class=\"hljs-attr\">description</span>: <span class=\"hljs-string\">&quot;Update the status of an existing ticket/issue&quot;</span>,\n      <span class=\"hljs-attr\">inputSchema</span>: {\n        <span class=\"hljs-attr\">id</span>: z.<span class=\"hljs-title function_\">number</span>().<span class=\"hljs-title function_\">describe</span>(<span class=\"hljs-string\">&quot;Issue ID to update&quot;</span>),\n        <span class=\"hljs-attr\">status</span>: z\n          .<span class=\"hljs-title function_\">enum</span>([<span class=\"hljs-string\">&quot;not_started&quot;</span>, <span class=\"hljs-string\">&quot;in_progress&quot;</span>, <span class=\"hljs-string\">&quot;done&quot;</span>])\n          .<span class=\"hljs-title function_\">describe</span>(<span class=\"hljs-string\">&quot;New status for the ticket&quot;</span>),\n        <span class=\"hljs-attr\">apiKey</span>: z.<span class=\"hljs-title function_\">string</span>().<span class=\"hljs-title function_\">describe</span>(<span class=\"hljs-string\">&quot;API key for authentication&quot;</span>),\n      },\n    },\n    <span class=\"hljs-title function_\">async</span> (params) =&gt; {\n      <span class=\"hljs-keyword\">const</span> { id, status, apiKey } = params;\n\n      <span class=\"hljs-keyword\">const</span> result = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">makeRequest</span>(\n        <span class=\"hljs-string\">&quot;PUT&quot;</span>,\n        <span class=\"hljs-string\">`<span class=\"hljs-subst\">${API_BASE_URL}</span>/issues/<span class=\"hljs-subst\">${id}</span>`</span>,\n        { status },\n        { <span class=\"hljs-attr\">headers</span>: { <span class=\"hljs-string\">&quot;x-api-key&quot;</span>: apiKey } }\n      );\n\n      <span class=\"hljs-keyword\">return</span> {\n        <span class=\"hljs-attr\">content</span>: [\n          {\n            <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&quot;text&quot;</span>,\n            <span class=\"hljs-attr\">text</span>: <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(result, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-number\">2</span>),\n          },\n        ],\n      };\n    }\n  );\n}\n</code></pre><p>Feel free to type this out, but in reality the <em>code</em> isn&#39;t very different, just the <em>semantics</em> are. So I&#39;d say go ahead and copy paste.</p>\n<p>Essentially we&#39;ve just narrowed down what we want our MCP server to do, added some strong opinions to it, and called it good. Instead of being able to have any tag be added on the fly, we&#39;re just allowing bugs and feature requests to be filed. Instead of worrying about users, we&#39;re letting it just be unassigned. This is less flexible, but after playing with it with a very small model for a while, I&#39;ve had 0 errors, as opposed to the probably 60% error rate I had with the API based tools.</p>\n<blockquote>\n<p>A note here: <em>sampling</em> like we talked about here would be super helpful. I&#39;d implement the tags and the users as sampling. I&#39;d request all the available tags and users then I&#39;d have the LLM choose the correct tags/users to apply. Elicitation could be good too - let the user choose - but if it&#39;s going to be an obvious answer then the LLM might as well do it.</p>\n</blockquote>\n<p>And that&#39;s our project!!</p>\n","markdown":"\nHere's a real interaction using the complete MCP server I just had with Qwen3:0.6B.\n\n```\n> ðŸ‘¤ using the issues-tracker-server mcp server, create a new issue in my issue tracker that tracks that I need to fix the login bug and mark it urgent and assign it to me. use the api key <API_KEY>\n\n> ðŸ¤– The tool call was made with the assigned_user_id set to \"me\", but the system is rejecting this, indicating a mismatch. The error suggests that the assigned user ID \"me\" does not exist in the system. Could you confirm that your assigned user ID is correctly set to \"your-own-id\" instead? Let me know, and I'll assist accordingly\n```\n\nThis is where just mapping your API server to an MCP server runs into trouble.\n\n- Sequential calls are hard to get right. In this case it'd need to use the API key to try to figure out who you are, then call create issue with that ID.\n- Giving a agent lots of tools may mean that it can be more flexible but it also leads to confusion. Just by including the health check, it will call it at unexpected times! Agents will make weird, questionable, or even downright-wrong decisions with which tool to use. A smaller set of focused tools is much more likely to succeed.\n- Generally speaking, you know the few actions you want your model to take. It's better to just codify these and slowly add more actions later.\n\nI'm going to call this \"jobs oriented\" MCP server as opposed to \"API oriented\". I made up these terms. But it suits what we're trying to get done today.\n\nInstead of having our infinitely flexible API server and hoping the LLM chooses right, let's say we know we really only want our MCP server to do three thinks\n\n- Create new bugs and mark them as high priority\n- Create new feature request and mark them as low priority\n- Update the status of a ticket\n\nFrankly, after writing these, they aren't that different. But man, the difference in success particularly with Qwen3:.6 is **night** and **day**.\n\n```javascript\nimport { z } from \"zod\";\n\nexport default function jobsBasedTools(server) {\n  const API_BASE_URL = process.env.API_BASE_URL || \"http://localhost:3000/api\";\n\n  // Hardcoded tag IDs from database\n  const BUG_TAG_ID = 3;\n  const FEATURE_TAG_ID = 4; // Helper function to make HTTP requests\n  async function makeRequest(method, url, data = null, options = {}) {\n    const config = {\n      method,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...options.headers,\n      },\n    };\n\n    // Merge other options except headers (which we already handled)\n    const { headers: _, ...otherOptions } = options;\n    Object.assign(config, otherOptions);\n\n    if (data) {\n      config.body = JSON.stringify(data);\n    }\n\n    try {\n      const response = await fetch(url, config);\n      const result = await response.text();\n\n      let jsonResult;\n      try {\n        jsonResult = JSON.parse(result);\n      } catch {\n        jsonResult = result;\n      }\n\n      return {\n        status: response.status,\n        data: jsonResult,\n        headers: Object.fromEntries(response.headers.entries()),\n      };\n    } catch (error) {\n      return {\n        status: 0,\n        error: error.message,\n      };\n    }\n  }\n\n  // Tool 1: Create new bug with high priority\n  server.registerTool(\n    \"create-bug\",\n    {\n      title: \"Create High Priority Bug\",\n      description: \"Create a new bug issue with high priority and bug tag\",\n      inputSchema: {\n        title: z.string().describe(\"Bug title\"),\n        description: z.string().describe(\"Bug description\"),\n        apiKey: z.string().describe(\"API key for authentication\"),\n      },\n    },\n    async (params) => {\n      const { apiKey, ...bugData } = params;\n\n      // Create bug with high priority and bug tag\n      const issueData = {\n        ...bugData,\n        priority: \"high\",\n        status: \"not_started\",\n        tag_ids: [BUG_TAG_ID], // Hardcoded bug tag ID\n      };\n\n      const result = await makeRequest(\n        \"POST\",\n        `${API_BASE_URL}/issues`,\n        issueData,\n        { headers: { \"x-api-key\": apiKey } }\n      );\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify(result, null, 2),\n          },\n        ],\n      };\n    }\n  );\n\n  // Tool 2: Create new feature request with low priority\n  server.registerTool(\n    \"create-feature-request\",\n    {\n      title: \"Create Low Priority Feature Request\",\n      description:\n        \"Create a new feature request issue with low priority and feature tag\",\n      inputSchema: {\n        title: z.string().describe(\"Feature request title\"),\n        description: z.string().describe(\"Feature request description\"),\n        apiKey: z.string().describe(\"API key for authentication\"),\n      },\n    },\n    async (params) => {\n      const { apiKey, ...featureData } = params;\n\n      // Create feature request with low priority and feature tag\n      const issueData = {\n        ...featureData,\n        priority: \"low\",\n        status: \"not_started\",\n        tag_ids: [FEATURE_TAG_ID], // Hardcoded feature tag ID\n      };\n\n      const result = await makeRequest(\n        \"POST\",\n        `${API_BASE_URL}/issues`,\n        issueData,\n        { headers: { \"x-api-key\": apiKey } }\n      );\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify(result, null, 2),\n          },\n        ],\n      };\n    }\n  );\n\n  // Tool 3: Update ticket status\n  server.registerTool(\n    \"update-ticket-status\",\n    {\n      title: \"Update Ticket Status\",\n      description: \"Update the status of an existing ticket/issue\",\n      inputSchema: {\n        id: z.number().describe(\"Issue ID to update\"),\n        status: z\n          .enum([\"not_started\", \"in_progress\", \"done\"])\n          .describe(\"New status for the ticket\"),\n        apiKey: z.string().describe(\"API key for authentication\"),\n      },\n    },\n    async (params) => {\n      const { id, status, apiKey } = params;\n\n      const result = await makeRequest(\n        \"PUT\",\n        `${API_BASE_URL}/issues/${id}`,\n        { status },\n        { headers: { \"x-api-key\": apiKey } }\n      );\n\n      return {\n        content: [\n          {\n            type: \"text\",\n            text: JSON.stringify(result, null, 2),\n          },\n        ],\n      };\n    }\n  );\n}\n```\n\nFeel free to type this out, but in reality the _code_ isn't very different, just the _semantics_ are. So I'd say go ahead and copy paste.\n\nEssentially we've just narrowed down what we want our MCP server to do, added some strong opinions to it, and called it good. Instead of being able to have any tag be added on the fly, we're just allowing bugs and feature requests to be filed. Instead of worrying about users, we're letting it just be unassigned. This is less flexible, but after playing with it with a very small model for a while, I've had 0 errors, as opposed to the probably 60% error rate I had with the API based tools.\n\n> A note here: _sampling_ like we talked about here would be super helpful. I'd implement the tags and the users as sampling. I'd request all the available tags and users then I'd have the LLM choose the correct tags/users to apply. Elicitation could be good too - let the user choose - but if it's going to be an obvious answer then the LLM might as well do it.\n\nAnd that's our project!!\n","slug":"jobs-based-tools","title":"Jobs Based Tools","section":"Our Project","icon":"screwdriver-wrench","filePath":"/home/runner/work/complete-intro-to-mcp/complete-intro-to-mcp/lessons/05-our-project/c-jobs-based-tools.md","nextSlug":"/lessons/sses-and-streaming-html/server-side-events","prevSlug":"/lessons/our-project/api-based-tools"}},"__N_SSG":true}